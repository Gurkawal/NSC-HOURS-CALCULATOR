<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>NSC Compliance Checker</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background: #f0f0f0;
    }
    h1 {
      color: #333;
    }
    input, select, button {
      margin: 5px 0;
      padding: 8px;
      width: 100%;
      box-sizing: border-box;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: center;
    }
    th {
      background-color: #eee;
    }
  </style>
</head>
<body>
  <h1>NSC Duty Hours Compliance Checker</h1>  <form id="dayForm">
    <label for="s1s">Shift 1 Start (24h):</label>
    <input type="time" id="s1s" name="s1s" required /><label for="s1e">Shift 1 End (24h):</label>
<input type="time" id="s1e" name="s1e" required />

<label for="s2s">Shift 2 Start (optional):</label>
<input type="time" id="s2s" name="s2s" />

<label for="s2e">Shift 2 End (optional):</label>
<input type="time" id="s2e" name="s2e" />

<label for="ots">Overtime Start (optional):</label>
<input type="time" id="ots" name="ots" />

<label for="ote">Overtime End (optional):</label>
<input type="time" id="ote" name="ote" />

<button type="submit">Submit Day</button>

  </form>  <div id="output"></div>  <script>
    const form = document.getElementById('dayForm');
    const output = document.getElementById('output');
    let prevEndMinutes = null;
    let total7DayHours = 0;
    let dayCount = 0;

    function parseMilitaryTime(timeStr) {
      if (!timeStr) return null;
      const [h, m] = timeStr.split(":").map(Number);
      return h * 60 + m;
    }

    form.addEventListener('submit', function(e) {
      e.preventDefault();
      const s1s = form.s1s.value;
      const s1e = form.s1e.value;
      const s2s = form.s2s.value;
      const s2e = form.s2e.value;
      const ots = form.ots.value;
      const ote = form.ote.value;

      const s1Start = parseMilitaryTime(s1s);
      let s1End = parseMilitaryTime(s1e);
      if (s1End < s1Start) s1End += 1440;
      const shift1 = (s1End - s1Start) / 60;

      let shift2 = 0;
      let s2Start = parseMilitaryTime(s2s);
      let s2End = parseMilitaryTime(s2e);
      if (s2Start !== null && s2End !== null) {
        if (s2End < s2Start) s2End += 1440;
        shift2 = (s2End - s2Start) / 60;
      }

      let splitHours = 0;
      if (s2Start !== null) {
        if (s2Start < s1End) s2Start += 1440;
        splitHours = (s2Start - s1End) / 60;
      }

      let otHours = 0;
      let otStart = parseMilitaryTime(ots);
      let otEnd = parseMilitaryTime(ote);
      if (otStart !== null && otEnd !== null) {
        if (otEnd < otStart) otEnd += 1440;
        otHours = (otEnd - otStart) / 60;
      }

      const totalDuty = shift1 + shift2 + otHours;
      const tet = shift2 ? (s2End - s1Start) / 60 : shift1;

      let offDuty = 0;
      if (prevEndMinutes !== null) {
        const currStartMinutes = s1Start < prevEndMinutes ? s1Start + 1440 : s1Start;
        offDuty = (currStartMinutes - prevEndMinutes) / 60;
      }
      prevEndMinutes = s2End || s1End;

      const violations = [];
      if (shift1 + shift2 > 14) violations.push("More than 14 on-duty hours");
      if (shift1 + shift2 > 13) violations.push("More than 13 driving hours");
      if (tet > 16) violations.push("More than 16 hours TET");
      if (offDuty < 8) violations.push("Less than 8 consecutive hours off-duty before start");
      total7DayHours += shift1 + shift2;
      if (++dayCount > 6 && total7DayHours > 70) violations.push("More than 70 on-duty hours in 7 days");

      const row = `
        <table>
          <tr><th>Day</th><th>Shift 1 (hrs)</th><th>Shift 2 (hrs)</th><th>Split (hrs)</th><th>OT (hrs)</th><th>Total Duty (hrs)</th><th>TET (hrs)</th><th>Off-duty (hrs)</th><th>Violations</th></tr>
          <tr><td>${dayCount}</td><td>${shift1}</td><td>${shift2}</td><td>${splitHours}</td><td>${otHours}</td><td>${totalDuty}</td><td>${tet}</td><td>${offDuty.toFixed(2)}</td><td>${violations.join(", ") || "None"}</td></tr>
        </table>
      `;

      output.innerHTML = row + output.innerHTML;
      form.reset();
    });
  </script></body>
</html>
